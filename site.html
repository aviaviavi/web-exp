<html>
<head>
	<style type="text/css">

	.circle {
		border-radius : 50%;
		height: 20px;
		width: 20px;
		background: blue;
		text-align: center;
		font-size: 11;
		position: absolute;
		-webkit-transition: background 1s ease;
    	-moz-transition: background 1s ease;
    	-o-transition: background 1s ease;
    	transition: background 1s ease;
	}

	.box {
		width:400px;
		padding:20px;
		height: 400px;
		border:7px solid gray;
		margin:0px;
	}

	.draggable { 
    	width: 40px; 
    	height: 40px; 
    	padding: 0.5em; 
    	float: left; 
    	margin: 0 10px 10px 0; 
    	background-color: yellow;
	}â€‹
	</style>

	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<script src="http://code.jquery.com/ui/1.8.24/jquery-ui.min.js"></script>

</head>
<body>

	<!--<div class='draggable' id='dragme'><img src=vaccine.jpg>vaccine</div>-->
	<div class='draggable' id='dragme'>vaccine</div>
	<div class='box'></div>

	<script>
	var numCircles = 30, 
		numChanges = 15, 
		changeInterval = 500,
		timeStep = 0,
		boxSize = 400,
		changes = [],
		houses = [];

	var House = function (houseNum) {
		this.houseNum = houseNum;
		this.htmlId = 'circle' + houseNum;
		this.x = Math.floor(Math.random()*boxSize + 20);
		this.y = Math.floor(Math.random()*boxSize + 20);
		this.infected = false;

		//add the house to the html
		this.display = function () {
			$("body").append("<div class='circle' id=" + this.htmlId + "></div>");
			$("#"+this.htmlId).css({top: this.y, left: this.x});
			houses.push(this);
		};

		this.infect = function(timeStep) {
			if (!this.infected) {
				$('#' + this.htmlId).css("background", "red").html('t=' + timeStep);
				changes.push(this.houseNum);
				this.infected = true;
			}
		};

		//is this house within some distance of another house?
		this.distanceTo = function(otherHouse) {
			xDiff = Math.abs(this.x - otherHouse.x);
			yDiff = Math.abs(this.y - otherHouse.y);
			distance = Math.sqrt(Math.pow(xDiff, 2) + Math.pow(yDiff, 2));
			return distance;
		};
	};

	//infect a random house
	function infectRandom () {
		var rand;
		do{
			rand = Math.floor(Math.random() * numCircles)
		} while (changes.lastIndexOf(rand) != -1);
		house = houses[rand];
		house.infect(timeStep);
		timeStep++;
	};

	//make houses, display them
	function generateHouses() {
		var house;
		for (i=0; i<numCircles; i++){
			house = new House(i);
			house.display();
		};
	};

	function clear() {
		clearInterval(r);
	};

	//where we actually start doing stuff
	generateHouses();

	var r = setInterval(infectRandom, changeInterval);
	setTimeout(clear, (numChanges+.5)*changeInterval);
	$('#dragme').draggable();

	</script>

</body>
</html>

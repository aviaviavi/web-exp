<html>
<head>
	<style type="text/css">

	.circle {
		border-radius : 50%;
		height: 20px;
		width: 20px;
		background: blue;
		text-align: center;
		font-size: 11;
		position: absolute;
		-webkit-transition: background 1s ease;
    	-moz-transition: background 1s ease;
    	-o-transition: background 1s ease;
    	transition: background 1s ease;
	}
	.box {
		width:400px;
		padding:20px;
		height: 400px;
		border:7px solid gray;
		margin:0px;
	}
	</style>
	<script src="http://code.jquery.com/jquery-latest.js">
	</script>
</head>
<body>

	<script>
	var numCircles = 30, 
		numChanges = 15, 
		changeInterval = 500,
		timeStep = 0,
		boxSize = 400,
		changes = [],
		houses = [];

	var House = function (houseNum) {
		this.houseNum = houseNum;
		this.htmlId = 'circle' + houseNum;
		this.x = Math.floor(Math.random()*boxSize + 20);
		this.y = Math.floor(Math.random()*boxSize + 20);
		this.infected = false;

		this.display = function () {
			$("body").append("<div class='circle' id=" + this.htmlId + "></div>");
			$("#"+this.htmlId).css({top: this.y, left: this.x});
			houses.push(this);
		};

		this.infect = function(timeStep) {
			if (!this.infected) {
				$('#' + this.htmlId).css("background", "red").html('t=' + timeStep);
				changes.push(this.houseNum);
				this.infected = true;
			}
		};
		
	};

	function infectRandom () {
		var rand;
		do{
			rand = Math.floor(Math.random() * numCircles)
		} while (changes.lastIndexOf(rand) != -1);
		house = houses[rand];
		house.infect(timeStep);
		timeStep++;
	};

	function start() {
		var house;
		for (i=0; i<numCircles; i++){
			house = new House(i);
			house.display();
		};
	};

	function clear() {
		clearInterval(r);
	}

	//where we actually start doing stuff
	start();

	var r = setInterval(infectRandom, changeInterval);
	setTimeout(clear, (numChanges+.5)*changeInterval);


	</script>

	<div class='box'></div>

</body>
</html>